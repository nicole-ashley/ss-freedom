import{r as t,h as o,H as e,g as i}from"./p-6096c7c7.js";import{A as r,a as n,E as s}from"./p-cc43f556.js";import"./p-fbc84a9a.js";import{E as a}from"./p-5019ae7a.js";import{E as d}from"./p-64abae57.js";const c=class{constructor(o){t(this,o),this.processing=!0,this.api=new r,this.instantiateOptionsForm()}componentDidLoad(){this.elementFollower=new a(this.element,this.host,{top:"0px",right:"0px"}),this.elementFollower.startFollowing()}disconnectedCallback(){this.elementFollower.stopFollowing()}startHorizontalDrag(){const t=this.handleHorizontalDrag.bind(this);document.body.addEventListener("pointermove",t),document.body.addEventListener("pointerup",(()=>document.body.removeEventListener("pointermove",t)),{once:!0})}handleHorizontalDrag(t){const o=this.host.getBoundingClientRect().right-t.clientX;this.host.style.setProperty("--width",o+"px")}async instantiateOptionsForm(){this.metadata=d.getDataForClosestObjectElement(this.element),this.formHtml=await this.api.getOptionsForm(this.metadata.class,this.metadata.id),this.processing=!1,window.requestAnimationFrame((()=>{this.host.style.setProperty("--initial-width",this.host.getBoundingClientRect().width+"px")}))}async saveChanges(){this.processing=!0;const t=Array.from(this.formWrapper.querySelectorAll("[name]")).reduce(((t,o)=>(o instanceof HTMLInputElement?t[o.name]="checkbox"===o.type?o.checked:o.value:o instanceof HTMLSelectElement?t[o.name]=o.options[o.selectedIndex].value:o instanceof HTMLTextAreaElement&&(t[o.name]=o.value),t)),{}),o=await this.api.updateObject(this.metadata.class,this.metadata.id,t);this.updateObjectHtml(o),this.close(),n.RefreshPublishedStatus()}updateObjectHtml(t){Array.from(document.querySelectorAll(`[ss-freedom-object="${this.metadata.uid}"]`)).forEach((o=>s.replaceObjectWithMostLikelyEquivalent(o,t))),this.removeOptionsButtonForOldObject()}removeOptionsButtonForOldObject(){Array.from(document.querySelectorAll(`ss-freedom-object-options-button[ss-freedom-uid="${this.metadata.uid}"]`)).forEach((t=>t.remove()))}close(){this.host.remove()}render(){return this.processing?o("ion-icon",{name:"refresh"}):o(e,{class:"loaded"},o("div",{ref:t=>this.formWrapper=t,innerHTML:this.formHtml}),o("button",{type:"submit",onClick:()=>this.saveChanges()},"Save"),o("button",{onClick:()=>this.close()},"Cancel"),o("div",{class:"horizontal-resize",onPointerDown:()=>this.startHorizontalDrag()}))}get host(){return i(this)}};c.style='*{font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif}a{color:#207ab7;transition:color 300ms;text-decoration:none}a:hover{color:#1c6ca1;text-decoration:underline}a:active{color:#185d8c}*{box-sizing:border-box}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{box-sizing:border-box;border:solid 1px lightgrey;border-radius:3px;border-top-right-radius:0;box-shadow:0 0 1rem rgba(0, 0, 0, 0.1);background-color:white;color:black;padding:0.5rem;line-height:0}:host(.loaded){border-left-style:double;border-left-width:3px;width:var(--width);min-width:var(--initial-width);max-width:100%}ion-icon{animation:1s infinite linear spin;font-size:1.25rem}form{margin:0;line-height:1}fieldset{border:0;padding:0.5rem;margin:0}.field{margin-bottom:0.5rem}label{color:rgba(34, 47, 62, 0.7);font-size:0.875rem}.middleColumn{margin-top:0.2rem;margin-bottom:0.5rem}input:not([type=checkbox]):not([type=radio]),select,textarea{border:solid 1px #ccc;border-radius:3px;padding:0.31rem 0.29rem;font-size:1rem;min-width:100%}input[type=checkbox],input[type=radio]{transform:translateY(2px)}input,select,textarea,button{font-size:1rem}button{float:right;margin-right:0.5rem;margin-bottom:0.5rem}button:not([type=submit]){appearance:none;border-radius:3px;border:none;padding:0.25rem 1rem;font-size:1rem;font-weight:bold;line-height:1.5rem;transition:background-color 300ms}button:not([type=submit]):disabled{color:rgba(0, 0, 0, 0.3);background-color:#f0f0f0}button:not([type=submit]):not(:disabled){color:#222f3e;background-color:#f0f0f0}button:not([type=submit]):not(:disabled):hover{background-color:#e3e3e3}button:not([type=submit]):not(:disabled):active{background-color:#d6d6d6}button[type=submit]{appearance:none;border-radius:3px;border:none;padding:0.25rem 1rem;font-size:1rem;font-weight:bold;line-height:1.5rem;transition:background-color 300ms}button[type=submit]:disabled{color:rgba(0, 0, 0, 0.3);background-color:#f0f0f0}button[type=submit]:not(:disabled){color:#fff;background-color:#207ab7}button[type=submit]:not(:disabled):hover{background-color:#1c6ca1}button[type=submit]:not(:disabled):active{background-color:#185d8c}.horizontal-resize{position:absolute;width:1rem;height:100%;top:0;left:-0.5rem;z-index:1;cursor:ew-resize;user-select:none}';export{c as ss_freedom_object_options_panel}