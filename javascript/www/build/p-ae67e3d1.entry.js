import{r as t,h as e,H as o,g as i}from"./p-224dc9de.js";import{A as n,S as r,E as s}from"./p-00b78c18.js";import{E as a}from"./p-b3df6588.js";import{E as d}from"./p-c44ccd61.js";const b=class{constructor(e){t(this,e),this.loading=!0,this.api=new n,this.instantiateOptionsForm()}componentDidLoad(){this.elementFollower=new d(this.element,this.host),this.elementFollower.startFollowing()}componentDidUnload(){this.elementFollower.stopFollowing()}startHorizontalDrag(){const t=this.handleHorizontalDrag.bind(this);document.body.addEventListener("pointermove",t),document.body.addEventListener("pointerup",()=>document.body.removeEventListener("pointermove",t),{once:!0})}handleHorizontalDrag(t){const e=this.host.getBoundingClientRect().right-t.clientX;this.host.style.setProperty("--width",e+"px")}async instantiateOptionsForm(){this.metadata=a.getObjectDataForFieldElement(this.element),this.formHtml=await this.api.getOptionsForm(this.metadata.class,this.metadata.id),this.loading=!1,window.requestAnimationFrame(()=>{this.host.style.setProperty("--initial-width",this.host.getBoundingClientRect().width+"px")})}async saveChanges(){this.loading=!0;const t=Array.from(this.formWrapper.querySelectorAll("[name]")).reduce((t,e)=>(e instanceof HTMLInputElement?t[e.name]="checkbox"===e.type?e.checked:e.value:e instanceof HTMLSelectElement?t[e.name]=e.options[e.selectedIndex].value:e instanceof HTMLTextAreaElement&&(t[e.name]=e.value),t),{}),e=await this.api.updateObject(this.metadata.class,this.metadata.id,t);this.updateObjectHtml(e),this.close(),r.RefreshPublishedStatus()}updateObjectHtml(t){Array.from(document.querySelectorAll(`[ss-freedom-object="${this.metadata.uid}"]`)).forEach(e=>s.replaceObjectWithMostLikelyEquivalent(e,t)),this.removeOptionsButtonForOldObject()}removeOptionsButtonForOldObject(){Array.from(document.querySelectorAll(`ss-freedom-object-options-button[ss-freedom-uid="${this.metadata.uid}"]`)).forEach(t=>t.remove())}close(){this.host.remove()}render(){return this.loading?e("ion-icon",{name:"sync"}):e(o,{class:"loaded"},e("div",{ref:t=>this.formWrapper=t,innerHTML:this.formHtml}),e("button",{type:"submit",onClick:()=>this.saveChanges()},"Save"),e("button",{onClick:()=>this.close()},"Cancel"),e("div",{class:"horizontal-resize",onPointerDown:()=>this.startHorizontalDrag()}))}get host(){return i(this)}};b.style='*{font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif}a{color:#207ab7;-webkit-transition:color 300ms;transition:color 300ms;text-decoration:none}a:hover{color:#1c6ca1;text-decoration:underline}a:active{color:#185d8c}*{-webkit-box-sizing:border-box;box-sizing:border-box}@-webkit-keyframes spin-anti{from{-webkit-transform:rotate(360deg);transform:rotate(360deg)}to{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}@keyframes spin-anti{from{-webkit-transform:rotate(360deg);transform:rotate(360deg)}to{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}:host{-webkit-box-sizing:border-box;box-sizing:border-box;border:solid 1px lightgrey;border-radius:3px;border-top-right-radius:0;-webkit-box-shadow:0 0 1rem rgba(0, 0, 0, 0.1);box-shadow:0 0 1rem rgba(0, 0, 0, 0.1);background-color:white;color:black;padding:0.5rem;line-height:0}:host(.loaded){border-left-style:double;border-left-width:3px;width:var(--width);min-width:var(--initial-width);max-width:100%}ion-icon{-webkit-animation:1s infinite linear spin-anti;animation:1s infinite linear spin-anti;font-size:1.25rem}form{margin:0;line-height:1}fieldset{border:0;padding:0.5rem;margin:0}.field{margin-bottom:0.5rem}label{color:rgba(34, 47, 62, 0.7);font-size:0.875rem}.middleColumn{margin-top:0.2rem;margin-bottom:0.5rem}input:not([type=checkbox]):not([type=radio]),select,textarea{border:solid 1px #ccc;border-radius:3px;padding:0.31rem 0.29rem;font-size:1rem;min-width:100%}input[type=checkbox],input[type=radio]{-webkit-transform:translateY(2px);transform:translateY(2px)}input,select,textarea,button{font-size:1rem}button{float:right;margin-right:0.5rem;margin-bottom:0.5rem}button:not([type=submit]){-webkit-appearance:none;-moz-appearance:none;appearance:none;border-radius:3px;border:none;padding:0.25rem 1rem;font-size:1rem;font-weight:bold;line-height:1.5rem;-webkit-transition:background-color 300ms;transition:background-color 300ms}button:not([type=submit]):disabled{color:rgba(0, 0, 0, 0.3);background-color:#f0f0f0}button:not([type=submit]):not(:disabled){color:#222f3e;background-color:#f0f0f0}button:not([type=submit]):not(:disabled):hover{background-color:#e3e3e3}button:not([type=submit]):not(:disabled):active{background-color:#d6d6d6}button[type=submit]{-webkit-appearance:none;-moz-appearance:none;appearance:none;border-radius:3px;border:none;padding:0.25rem 1rem;font-size:1rem;font-weight:bold;line-height:1.5rem;-webkit-transition:background-color 300ms;transition:background-color 300ms}button[type=submit]:disabled{color:rgba(0, 0, 0, 0.3);background-color:#f0f0f0}button[type=submit]:not(:disabled){color:#fff;background-color:#207ab7}button[type=submit]:not(:disabled):hover{background-color:#1c6ca1}button[type=submit]:not(:disabled):active{background-color:#185d8c}.horizontal-resize{position:absolute;width:1rem;height:100%;top:0;left:-0.5rem;z-index:1;cursor:ew-resize;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}';export{b as ss_freedom_object_options_panel}