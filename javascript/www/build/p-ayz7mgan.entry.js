import{r as t,h as e,H as s,g as o}from"./p-4054c6de.js";import{A as a}from"./p-1c7b096a.js";class i{constructor(e){t(this,e),this.loading=!0,this.api=new a,this.instantiateOptionsForm()}async instantiateOptionsForm(){this.formHtml=await this.api.getOptionsForm(this.objectClass,this.objectId),this.loading=!1}async saveChanges(){this.loading=!0;const t=Array.from(this.formWrapper.querySelectorAll("[name]")).reduce((t,e)=>(e instanceof HTMLInputElement?t[e.name]=e.value:e instanceof HTMLSelectElement?t[e.name]=e.options[e.selectedIndex].value:e instanceof HTMLTextAreaElement&&(t[e.name]=e.value),t),{}),e=await this.api.updateObject(this.objectClass,this.objectId,t);this.updateObjectHtml(e),this.close()}updateObjectHtml(t){const e=[`[data-ss-freedom-object*='"class":"${this.objectClass.replace(/\\/g,"\\\\\\\\")}"']`,`[data-ss-freedom-object*='"id":${this.objectId}']`];Array.from(document.querySelectorAll(e.join(""))).forEach(e=>e.outerHTML=t),this.removeOptionsButtonForOldObject()}removeOptionsButtonForOldObject(){const t=[`ss-freedom-object-options-button[object-class="${this.objectClass.replace(/\\/g,"\\\\")}"]`,`[object-id="${this.objectId}"]`];Array.from(document.querySelectorAll(t.join(""))).forEach(t=>t.remove())}close(){this.host.remove()}render(){return this.loading?e("ion-icon",{className:"loading",name:"sync"}):e(s,null,e("div",{ref:t=>this.formWrapper=t,innerHTML:this.formHtml}),e("button",{onClick:()=>this.saveChanges()},"Save"),e("button",{onClick:()=>this.close()},"Cancel"))}get host(){return o(this)}static get style(){return":host{outline:1px solid grey;background-color:#fff;color:#000;padding:.5rem}ion-icon.loading{-webkit-animation:spin 1s linear infinite;animation:spin 1s linear infinite;font-size:1.25rem}form{margin:0}fieldset{border:0;padding:.5rem;padding-bottom:0}.field{margin-bottom:.5rem}label{font-size:.75rem;font-weight:600}.middleColumn{margin-top:.25rem;margin-bottom:1rem}input,select,textarea{min-width:100%}button,input,select,textarea{font-size:1rem}button{margin:.5rem}\@-webkit-keyframes spin{0%{-webkit-transform:rotate(1turn);transform:rotate(1turn)}to{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}\@keyframes spin{0%{-webkit-transform:rotate(1turn);transform:rotate(1turn)}to{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}"}}export{i as ss_freedom_object_options_panel};